---
title: "Benchmarking {SpeedyMarkov}"
author: "Sam Abbott"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Benchmarking {SpeedyMarkov}}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE, comment = "#>",
  fig.width = 7, fig.height = 7, 
  fig.align = "center"
)
```

## Benchmarking setup


The benchmarking grid has been implemented within `SpeedyMarkov` - see below.

```{r}
library(SpeedyMarkov)
library(microbenchmark)
library(parallel)
library(furrr)
library(ggplot2)

SpeedyMarkov::benchmark_markov
```

All benchmarking results have been run elsewhere (`inst/scripts/benchmarking`) and then saved (`inst/benchmarks`). These benchmarks can be recreated locally using the following in the package directory.

```{bash, eval = FALSE}
Rscript inst/scripts/benchmarking.R
```

## Two state Markov model

The two state Markov model has been benchmarked for both 100 cycles and 1000 cycles (duration) for 100,000 samples - repeated 10 times per benchmark.

### Duration: 100


* Table

```{r}
two_state_bench_dur_100 <- readRDS("../inst/benchmarks/two_state_duration_100.rds")

two_state_bench_dur_100
```

* Plot

```{r, width = 12, height = 8}
ggplot2::autoplot(two_state_bench_dur_100) +
  theme_minimal()
```

### Duration: 1000

```{r, width = 10, height = 10, eval = FALSE}
two_state_bench_dur_1000 <- readRDS("../inst/benchmarks/two_state_duration_1000.rds")

two_state_bench_dur_1000
```


```{r, width = 12, height = 8}
ggplot2::autoplot(two_state_bench_dur_1000) +
  theme_minimal()
```
